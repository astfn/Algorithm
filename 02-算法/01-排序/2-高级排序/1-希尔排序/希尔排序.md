åœ¨æ’å…¥æ’åºä¸­ï¼Œ`ç¬¬äºŒå±‚forå¾ªç¯`ç»´æŠ¤çš„æ˜¯`å·²æ’åºéƒ¨åˆ†`ï¼Œè®©æœªæ’åºéƒ¨åˆ†çš„ç¬¬ä¸€ä¸ªå…ƒç´ ä¸å·²æ’åºä¸­çš„å…ƒç´ å¯¹æ¯”ï¼Œä¸€æ—¦ç¬¦åˆè¦æ±‚å°±è¿›è¡Œæ•°æ®çš„äº¤æ¢ï¼Œäº¤æ¢æ¬¡æ•°å¾ˆé¢‘ç¹ã€‚

å¸Œå°”æ’åºï¼Œæ˜¯å‡çº§ç‰ˆçš„æ’å…¥æ’åºï¼Œç›¸å¯¹äºæ’å…¥æ’åºï¼Œå‡å°‘äº†æ•°æ®äº¤æ¢çš„æ¬¡æ•°ã€‚

## æ’åºçš„åŸç†

â€‹	ä¹‹æ‰€ä»¥èƒ½è¾¾åˆ°å‡å°‘äº¤æ¢æ¬¡æ•°çš„æ•ˆæœï¼Œæ˜¯å› ä¸ºå¯¹æ•°æ®è¿›è¡Œäº†åˆ†ç»„ï¼Œä¸”åªå¯¹æ¯ç»„çš„é¦–å°¾å…ƒç´ è¿›è¡Œåˆ¤æ–­ï¼ˆé¦–å…ƒç´ ä»£è¡¨å·²æ’åºéƒ¨åˆ†ï¼Œå°¾å…ƒç´ ä»£è¡¨æœªæ’åºéƒ¨åˆ†ï¼‰ï¼Œç¬¦åˆè¦æ±‚å°±äº¤æ¢ä½ç½®ã€‚å¹¶ä¸”æ¯ç»è¿‡ä¸€è¶Ÿæ’åºï¼Œå¢é‡héƒ½è¦ç¼©å‡ä¸ºåŸæ¥çš„ä¸€åŠï¼Œæ¥ä¸æ–­æé«˜æ’åºçš„ç²¾åº¦ã€‚ç›´è‡³h==1ã€‚

1. é€‰å®šä¸€ä¸ªå¢é•¿é‡hï¼Œä½œä¸ºæ•°æ®åˆ†ç»„çš„ä¾æ®ã€‚
2. å¯¹æŒ‰håˆ†å¥½çš„æ¯ä¸€ç»„æ•°æ®å®Œæˆæ’å…¥æ’åºã€‚
3. å‡å°å¢é•¿é‡h(æœ€å°ä¸º1)ï¼Œé‡å¤ç¬¬äºŒæ­¥æ“ä½œ

## ä¼ªä»£ç 

```
åˆå§‹åŒ–h;

//åœ¨hå˜ä¸º1ä¹‹å‰ï¼Œä¸æ–­è¿›è¡Œæ’åº
while (h >= 1) {
  //æ‰¾åˆ°å¾…æ’å…¥å…ƒç´ 
  for (let i = h; i < arr.length; i++) {
    //æŠŠå¾…æ’å…¥å…ƒç´ ï¼Œæ’å…¥åˆ°æœ‰åºéƒ¨åˆ†,å¯¹æ‰€æœ‰çš„åˆ†ç»„éƒ½æ‰§è¡Œè¯¥æ“ä½œ
    for (let j = i; j >= h; j -= h) {
      if (arr[j] > arr[j - h]) {
        change;
      } else {
        break;
      }
    }
  }
  //æ¯æ’åºä¸€ä¸ªåˆ†ç»„ï¼Œh/2
  h = h / 2;
}
```

## hå˜é‡çš„å®šä¹‰

### åˆå§‹åŒ–è§„åˆ™

1. è®¾ç½®ä¸º`1`
2. å¦‚æœhå°äºæ•°ç»„é•¿åº¦çš„ä¸€åŠï¼Œå°±ä¸æ–­è®©å…¶`h=h*2+1`

```
let h = 1;
while (h < arr.length / 2) {
  h = h * 2 + 1;
}
```

### ç¼©å°è§„åˆ™

* æ¯æ¬¡ç¼©å°ä¸ºåŸæ¥çš„ä¸€åŠï¼Œå‘ä¸‹å–æ•´

```
//æ¯ç»è¿‡ä¸€è½®æ’åºï¼Œéƒ½è¦è®©h/2
h = Math.floor(h / 2);
```

## çœŸæ­£å®ç°

**å·¥å…·å‡½æ•°**

```
function change(arr, i, j) {
  let temp = arr[i];
  arr[i] = arr[j];
  arr[j] = temp;
}
```

```
function sort(arr, callback) {
  //åˆå§‹åŒ–å¢é‡h
  let h = 1;
  while (h < arr.length / 2) {
    h = h * 2 + 1;
  }
  //å¸Œå°”æ’åº
  //åœ¨hå˜ä¸º1ä¹‹å‰ï¼Œä¸æ–­è¿›è¡Œæ’åº
  while (h >= 1) {
    //æ‰¾åˆ°å¾…æ’åºçš„å…ƒç´ 
    for (let i = h; i < arr.length; i++) {
      //å°†å¾…æ’åºå…ƒç´ æ’å…¥å·²æ’åºéƒ¨åˆ†,å¯¹æ‰€æœ‰çš„åˆ†ç»„éƒ½æ‰§è¡Œè¯¥æ“ä½œ
      for (j = i; j >= h; j -= h) {
        if (callback(arr[j - h], arr[j]) > 0) {
          change(arr, j, j - h);
        } else {
          break;
        }
      }
    }
    //æ¯ç»è¿‡ä¸€è½®æ’åºï¼Œéƒ½è¦è®©h/2
    h = Math.floor(h / 2);
    console.log(h);
  }
}
```

**æµ‹è¯•**

```
let arr = [9, 1, 2, 5, 7, 4, 8, 6, 3, 5];
sort(arr, (a, b) => {
  return b - a;
});
console.log(arr);
```



## æµ‹è¯•æ‰§è¡Œæ•ˆç‡

```
//å·¥å…·å‡½æ•°
function change(arr, i, j) {
  let temp = arr[i];
  arr[i] = arr[j];
  arr[j] = temp;
}
function initArr() {
  let first = 10000;
  let arr = [];
  for (let i = first; i >= 1; i--) {
    arr.push(i);
  }
  return arr;
}
```

```
//æ’å…¥æ’åºæµ‹è¯•
{
  console.log("æ’å…¥æ’åºğŸ‘‡");
  let arr = initArr();

  function sort(arr, callback) {
    for (let i = 1; i < arr.length; i++) {
      for (let j = i; j > 0; j--) {
        if (callback(arr[j - 1], arr[j]) > 0) {
          change(arr, j, j - 1);
        } else {
          break;
        }
      }
    }
  }
  console.time("a");
  sort(arr, (a, b) => {
    return a - b;
  });
  console.log(arr);
  console.timeEnd("a");
}
```

```
//å¸Œå°”æ’åºæµ‹è¯•
{
  console.log("å¸Œå°”æ’åºğŸ‘‡");
  let arr = initArr();
  function sort(arr, callback) {
    //åˆå§‹åŒ–å¢é‡h
    let h = 1;
    while (h < arr.length / 2) {
      h = h * 2 + 1;
    }
    //å¸Œå°”æ’åº
    while (h >= 1) {
      for (let i = h; i < arr.length; i++) {
        for (j = i; j >= h; j -= h) {
          if (callback(arr[j - h], arr[j]) > 0) {
            change(arr, j, j - h);
          } else {
            break;
          }
        }
      }
      //æ¯ç»è¿‡ä¸€è½®æ’åºï¼Œéƒ½è¦è®©h/2
      h = Math.floor(h / 2);
    }
  }
  console.time("b");
  sort(arr, (a, b) => {
    return a - b;
  });
  console.log(arr);
  console.timeEnd("b");
}
```

**ç»“æœ**

<img src="å¸Œå°”æ’åº.assets/001.png" alt="001" style="zoom:80%;" />

